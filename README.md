# Тестовое задание: автотесты для https://piter-online.net/

Репозиторий содержит автотесты на **Python + Playwright + pytest** для проверки типовых пользовательских сценариев.

## Стек

- Python
- Playwright (`pytest-playwright`)
- pytest

## Подготовка окружения

Рекомендуемый порядок действий (Windows):

```bash
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
playwright install
```

После этого Playwright загрузит браузеры, и тесты можно запускать.

## Запуск тестов

Базовый запуск всех тестов:

```bash
pytest
```

Тесты используют встроенную фикстуру `page` из `pytest-playwright`.  
Для отладки можно запускать отдельные файлы, например:

```bash
pytest tests/test_application_form.py
pytest tests/test_region.py
pytest tests/test_status_code.py
```

## Реализованные сценарии

### 1. Проверка HTTP-кода главной страницы

Файл: `tests/test_status_code.py`

- Отправляем HTTP-запрос к главной странице `https://piter-online.net/` через `page.request`.
- Проверяем, что статус ответа **200**.
- Тест параметризован и выполняется **5 раз** подряд в рамках одного запуска:
  - позволяет поймать возможные нестабильности на уровне сети/инфраструктуры.

### 2. Автоматизация подачи заявки

Файл: `tests/test_application_form.py`  
Page Object: `pages/main_page.py`

Сценарий:

1. Открыть главную страницу.
2. Выполнить поиск по адресу:
   - Улица: `Тестовая линия`
   - Дом: `1`
3. Открыть форму заявки по найденному адресу.
4. Заполнить форму:
   - Имя: `Автотест`
   - Телефон: `1111111111`
5. Отправить форму.
6. Проверить, что пользователь видит **подтверждение успешной отправки заявки** (стабильный текст/элемент).

Тест также параметризован на **5 прогонов**, что помогает отловить флейки.

### 3. Поиск по адресу / смена региона

Файл: `tests/test_region.py`  
Page Object: `pages/main_page.py`

Сценарий:

1. Открыть главную страницу.
2. Открыть селектор региона.
3. Выбрать регион (например, `Санкт-Петербург`).
4. Проверить, что выбранный регион корректно отображается в шапке сайта.

Тест параметризован на 5 повторов.

## Структура проекта

- `pages/` — Page Object-ы (на данный момент `MainPage` для главной страницы).
- `tests/` — автотесты:
  - `test_status_code.py` — проверка HTTP 200.
  - `test_application_form.py` — сценарий отправки заявки.
  - `test_region.py` — сценарий смены региона.
- `requirements.txt` — зависимости.
- `pytest.ini` — базовая конфигурация pytest.

## Подход и технические решения

- **Page Object**:
  - вынесена логика работы с главной страницей в `MainPage`;
  - упрощает поддержку и расширение тестов при изменениях в верстке.
- **Устойчивые локаторы**:
  - используются `role`/`name` и `placeholder`, а не только `xpath/css`;
  - комментарии в коде отмечают места, где при реальной работе нужно зафиксировать точные селекторы после анализа DOM.
- **Стабильность**:
  - критичные сценарии прогоняются по 5 раз в рамках одного запуска (`pytest.mark.parametrize`);
  - не используются «глухие» `sleep`, предпочтение отдаётся ожиданиям Playwright (через локаторы и встроенные ожидания).

## SEO и отчётность

### SEO-проверки

Файл: `tests/test_seo.py`

- проверяется, что:
  - `<title>` главной страницы не пустой;
  - основной заголовок `h1` присутствует и видим;
  - `meta[name="description"]` существует и содержит текст.

### HTML-отчёт pytest

Для формирования HTML-отчёта используется плагин `pytest-html` (добавлен в `requirements.txt`).

Пример команды:

```bash
pytest --html=report.html --self-contained-html
```

В результате в корне проекта появится файл `report.html` с отчётом о последнем прогоне тестов.

## Время выполнения задания

> Здесь можно указать общее время, затраченное на выполнение (например, "около 4 часов").

